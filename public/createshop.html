<script type="module">
    import { supabase } from './js/supabaseClient.js';
    import { requireLogin } from './js/auth.js';

    document.addEventListener('DOMContentLoaded', async () => {
        console.log("[DEBUG] üöÄ Initializing Create Shop Page...");
        await requireLogin();

        const form = document.getElementById('create-shop-form');
        form.addEventListener('submit', async (event) => {
            event.preventDefault();

            const shopName = document.getElementById('shopName').value.trim();
            if (!shopName) {
                alert("‚ö†Ô∏è Please enter a shop name!");
                return;
            }

            console.log("[DEBUG] Creating shop:", shopName);
            const { data, error } = await supabase.from('shops').insert([{ name: shopName }]);

            if (error) {
                console.error("[DEBUG] ‚ùå Error creating shop:", error);
                alert("‚ùå Error creating shop! Try again.");
            } else {
                console.log("[DEBUG] ‚úÖ Shop created:", data);
                alert("‚úÖ Shop successfully created!");
                window.location.href = "/myshops.html";
            }
        });
    });
</script>
